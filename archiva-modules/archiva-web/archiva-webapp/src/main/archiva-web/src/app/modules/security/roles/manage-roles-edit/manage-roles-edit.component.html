<!--
  ~ Licensed to the Apache Software Foundation (ASF) under one
  ~ or more contributor license agreements.  See the NOTICE file
  ~ distributed with this work for additional information
  ~ regarding copyright ownership.  The ASF licenses this file
  ~ to you under the Apache License, Version 2.0 (the
  ~ "License"); you may not use this file except in compliance
  ~ with the License.  You may obtain a copy of the License at
  ~
  ~ http://www.apache.org/licenses/LICENSE-2.0
  ~ Unless required by applicable law or agreed to in writing,
  ~ software distributed under the License is distributed on an
  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
  ~ KIND, either express or implied.  See the License for the
  ~ specific language governing permissions and limitations
  ~ under the License.
  -->

<form class="mt-3 mb-3" [formGroup]="userForm" (ngSubmit)="onSubmit()">
    <div class="form-group row col-md-8">
        <div class="col-md-1" *ngIf="editRole && !editRole.permanent">{{'form.edit' |translate}}&nbsp;<span
                class="fas fa-edit"></span></div>
        <div class="col-md-6" *ngIf="editRole && !editRole.permanent">
            <input class="form-check-input" type="checkbox" [value]="editMode" [checked]="editMode"
                   (change)="editMode=!editMode"
            >
        </div>
    </div>
    <div class="form-group row col-md-8">
        <label class="col-md-2 col-form-label" for="id">{{'roles.attributes.id' |translate}}</label>
        <div class="col-md-6">
            <input type="text" formControlName="id" id="id"
                   [ngClass]="valid('id')"
                   [attr.readonly]="true">
        </div>
    </div>
    <div class="form-group row col-md-8">
        <label class="col-md-2 col-form-label" for="id">{{'roles.attributes.name' |translate}}</label>
        <div class="col-md-6">
            <input type="text" formControlName="name" id="name"
                   [ngClass]="valid('name')"
                   [attr.readonly]="editMode?null:'true'">
        </div>
    </div>
    <div class="form-group row col-md-8">
        <label class="col-md-2 col-form-label" for="id">{{'roles.attributes.description' |translate}}</label>
        <div class="col-md-6">
            <input type="text" formControlName="description" id="description"
                   [ngClass]="valid('description')"
                   [attr.readonly]="editMode?null:'true'">
        </div>
    </div>
    <div class="form-group row col-md-8">
        <label class="col-md-2 col-form-label" for="id">{{'roles.attributes.resource' |translate}}</label>
        <div class="col-md-6">
            <input type="text" formControlName="resource" id="resource"
                   [ngClass]="valid('resource')"
                   [attr.readonly]="true">
        </div>
    </div>
    <div class="form-group row col-md-8">
        <div class="col-md-2"></div>
        <div class="col-md-6">
            <div class="form-check">
                <input class="form-check-input" type="checkbox" formControlName="assignable"
                       id="assignable" [attr.disabled]="true">
                <label class="form-check-label " for="assignable">
                    {{'roles.attributes.assignable'|translate}}
                </label>
            </div>
            <div class="form-check">
                <input class="form-check-input" type="checkbox" formControlName="template_instance"
                       id="template_instance" [attr.disabled]="true">
                <label class="form-check-label " for="template_instance">
                    {{'roles.attributes.template_instance'|translate}}
                </label>
            </div>
        </div>
    </div>
</form>
<hr/>
<ngb-accordion activeIds="parents,children,permissions">
    <ngb-panel id="parents" >
        <ng-template ngbPanelHeader let-opened="opened">
            <div class="d-flex align-items-center justify-content-between">
                <button ngbPanelToggle class="btn btn-link text-left shadow-none"><h3>{{'roles.edit.parents'|translate}}</h3></button>
                <ng-container *ngIf="!opened"><i class="fa fa-eye-slash"></i></ng-container>
                <ng-container *ngIf="opened"><i class="fa fa-eye"></i></ng-container>
            </div>
        </ng-template>
        <ng-template ngbPanelContent>
                <ng-container *ngIf="editRole?.parents.length>0">
                    <ul class="list-group" *ngFor="let parentRole of editRole?.parents">
                        <li class="list-group-item"><a routerLink="../{{parentRole?.id}}">{{parentRole?.name}}</a></li>
                    </ul>
                </ng-container>
        </ng-template>
    </ngb-panel>
    <ngb-panel id="children">
        <ng-template ngbPanelHeader let-opened="opened">
            <div class="d-flex align-items-center justify-content-between">
            <button ngbPanelToggle class="btn btn-link text-left shadow-none"><h3>{{'roles.edit.children'|translate}}</h3></button>
            <ng-container *ngIf="!opened"><i class="fa fa-eye-slash"></i></ng-container>
            <ng-container *ngIf="opened"><i class="fa fa-eye"></i></ng-container>
            </div>
        </ng-template>
        <ng-template ngbPanelContent>
                <ng-container *ngIf="editRole?.children.length>0">
                    <ul class="list-group" *ngFor="let childRole of editRole?.children">
                        <li class="list-group-item"><a routerLink="../{{childRole?.id}}">{{childRole?.name}}</a></li>
                    </ul>
                </ng-container>
        </ng-template>
    </ngb-panel>

    <ngb-panel id="permissions">
        <ng-template ngbPanelHeader let-opened="opened">
            <div class="d-flex align-items-center justify-content-between">

            <button ngbPanelToggle class="btn btn-link text-left shadow-none"><h3>{{'roles.edit.permissions'|translate}}</h3></button>
            <ng-container *ngIf="!opened"><i class="fa fa-eye-slash"></i></ng-container>
            <ng-container *ngIf="opened"><i class="fa fa-eye"></i></ng-container>
            </div>
        </ng-template>
        <ng-template ngbPanelContent>
                <ng-container *ngIf="editRole">
                    <table class="table">
                        <thead>
                        <tr>
                            <th>{{'permissions.attributes.permission'|translate}}</th>
                            <th>{{'permissions.attributes.operation'|translate}}</th>
                            <th>{{'permissions.attributes.resource'|translate}}</th>
                        </tr>
                        </thead>
                        <tbody *ngFor="let perm of editRole.permissions">
                        <tr>
                            <td>{{perm.name}}</td>
                            <td>{{perm.operation.name}}</td>
                            <td>{{perm.resource.identifier}}</td>
                        </tr>
                        </tbody>

                    </table>
                </ng-container>
        </ng-template>
    </ngb-panel>

    <ngb-panel>
        <ng-template ngbPanelHeader let-opened="opened">
            <div class="d-flex align-items-center justify-content-between">
                <button ngbPanelToggle class="btn btn-link text-left shadow-none"><h3>{{'roles.edit.users'|translate}}</h3></button>
                <ng-container *ngIf="!opened"><i class="fa fa-eye-slash"></i></ng-container>
                <ng-container *ngIf="opened"><i class="fa fa-eye"></i></ng-container>
            </div>
        </ng-template>
        <ng-template ngbPanelContent >
             <h3>There are the users</h3>
        </ng-template>
    </ngb-panel>

</ngb-accordion>
