<!DOCTYPE html>

<!--
~  ~ Licensed to the Apache Software Foundation (ASF) under one
~  ~ or more contributor license agreements.  See the NOTICE file
~  ~ distributed with this work for additional information
~  ~ regarding copyright ownership.  The ASF licenses this file
~  ~ to you under the Apache License, Version 2.0 (the
~  ~ "License"); you may not use this file except in compliance
~  ~ with the License.  You may obtain a copy of the License at
~  ~
~  ~  http://www.apache.org/licenses/LICENSE-2.0
~  ~
~  ~ Unless required by applicable law or agreed to in writing,
~  ~ software distributed under the License is distributed on an
~  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
~  ~ KIND, either express or implied.  See the License for the
~  ~ specific language governing permissions and limitations
~  ~ under the License.
~  -->

<html>
<head>
  <link rel="stylesheet" href="css/prettify.css"/>
  <link rel="stylesheet" href="css/jquery.fileupload-ui.css"/>
  <link rel="stylesheet" href="css/jqueryFileTree.css"/>
  <link rel="stylesheet" href="css/chosen-0.9.7.css"/>
  <link rel="stylesheet" href="css/jquery-ui-1.8.16.custom.css"/>
  <link rel="stylesheet" href="css/bootstrap.2.1.0.css">
  <link rel="stylesheet" href="css/archiva.css">
  <link rel="shortcut icon" href="favicon.ico"/>


  <script type="text/javascript" src="js/jquery-1.8.0.min.js"></script>
  <script type="text/javascript" src="js/sammy.0.7.1.js"></script>
  <script type="text/javascript" src="js/require.2.0.2.js"></script>

  <title>Apache Archiva</title>

</head>

<body id="body_content" style="padding-top: 42px;">

<div id="topbar-menu-container"></div>

<div class="container-fluid" style="min-height: 550px">
  <div class="row-fluid">
    <div class="span2 columns">
      <div class="well sidebar-nav" id="sidebar-content"></div>
    </div>
    <div class="span10 columns">
      <div class="content">
        <div id="user-messages"></div>
        <div id="main-content"></div>
    </div>
  </div>
  </div>

</div>

<footer id="footer-content" style="vertical-align: bottom">
</footer>

<div id="html-fragments"></div>

<div id="dialog-confirm" title="" style="display: none">
</div>



<script type="text/javascript">

    appendArchivaVersion=function(){
      return "_archivaVersion="+window.archivaRuntimeInfo.version;
    }

    timestampNoCache=function(){
      if (window.archivaRuntimeInfo.version.match("SNAPSHOT$")=="SNAPSHOT"){
        return "&archivaTimestamp="+window.archivaRuntimeInfo.timestamp+(window.archivaRuntimeInfo.devMode?"&_="+jQuery.now():"");
      }
      return "";
    }

    appendTemplateUrl=function(){
      return appendArchivaVersion()+timestampNoCache();
    }

    appendJsNoCacheUrl=function(){
      return appendArchivaVersion()+timestampNoCache();
    }

    $.ajax({
        url: "restServices/archivaUiServices/runtimeInfoService/archivaRuntimeInfo/en",
        dataType: 'json',
        cache: false,
        success:function(data){

            window.archivaDevMode=data.devMode;
            window.archivaJavascriptLog=data.javascriptLog;
            window.archivaRuntimeInfo=data;

                require.config({
                    baseUrl: "js/",
                    urlArgs: ""+appendJsNoCacheUrl(),
                    shim: {
                            'sammy':['jquery'],
                            'archiva.main':["jquery","sammy"]
                          },
                    paths: {
                        "i18n":"jquery.i18n.properties-1.0.9",
                        "jquery": "jquery-1.8.0.min",
                        "jquery.tmpl": "jquery.tmpl",
                        "utils": "archiva/utils",
                        "startup": "archiva/startup",
                        "jquery.ui": "jquery-ui-1.8.16.custom.min",
                        "jquery.ui.widget": "jquery.ui.widget-1.8.18",
                        "jquery.cookie": "jquery.cookie.1.0.0",
                        "bootstrap": "bootstrap.2.1.0",
                        "choosen": "chosen.jquery-0.9.7",
                        "jquery.validate": "jquery.validate-1.9.0",
                        "jquery.json": "jquery.json-2.3.min",
                        "knockout": "knockout-2.0.0.debug",
                        "knockout.simpleGrid": "knockout.simpleGrid",
                        "knockout.sortable": "knockout-sortable",
                        "jquery.iframe.transport": "jquery.iframe-transport-1.4",
                        "jquery.fileupload": "jquery.fileupload-5.10.0",
                        "jquery.fileupload.ip":"jquery.fileupload-ip-1.0.6",
                        "jquery.fileupload.ui":"jquery.fileupload-ui-6.6.3",
                        "tmpl": "tmpl.min",
                        "prettify": "prettify",
                        "sammy": "sammy.0.7.1",
                        "jqueryFileTree": "jqueryFileTree-1.0.1",
                        "redback": "redback/redback",
                        "redback.roles": "redback/roles",
                        "redback.user": "redback/user",
                        "redback.users": "redback/users",
                        "redback.templates": "redback/redback-tmpl",
                        "archiva.general-admin":"archiva/general-admin",
                        "archiva.templates": "archiva/main-tmpl",
                        "archiva.repositories": "archiva/repositories",
                        "archiva.network-proxies": "archiva/network-proxies",
                        "archiva.proxy-connectors": "archiva/proxy-connectors",
                        "archiva.repository-groups": "archiva/repository-groups",
                        "archiva.artifacts-management": "archiva/artifacts-management",
                        "archiva.search": "archiva/search",
                        "archiva.main": "archiva/main"
                    }
                });

                require(['jquery','jquery.tmpl','i18n','sammy','startup','utils','domReady!'], function (domReady) {
                    loadi18n(function () {
                      $.ajax({
                          url: "restServices/archivaUiServices/runtimeInfoService/archivaRuntimeInfo/"+usedLang(),
                          dataType: 'json',
                          success:function(data){
                              window.archivaDevMode=data.devMode;
                              window.archivaJavascriptLog=data.javascriptLog;
                              window.archivaRuntimeInfo=data;

                              require(['sammy','archiva.main','domReady!'],function (domReady) {
                                  startArchivaApplication();
                                  $("#loadingDiv").hide();
                              })
                          }
                        })
                    })
                });
        }
    })


</script>

<div id="loadingDiv">
  <div class="loading-indicator">
    <img src="images/medium-spinner.gif" />
    <span id="loading-msg">Loading</span>
  </div>
</div>

</body>
</html>
