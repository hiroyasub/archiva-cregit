<script id="rolesTabs" type="text/x-jquery-tmpl">
  <div class="page-header">
    <h2>${$.i18n.prop('roles.list')}</h2>
  </div>

  <ul id="roles-view-tabs" class="tabs">
    <li class="active" id="roles-view-tabs-li-roles-grid">
      <a href="#roles-view">${$.i18n.prop('roles.grid.tab.title')}</a>
    </li>
    <li id="roles-view-tabs-li-roles-edit">
      <a href="#role-edit">${$.i18n.prop('edit')}</a>
    </li>
  </ul>
  <div id="roles-view-tabs-content" class="tab-content">
    <div id="roles-view">
        <table class="bordered-table zebra-striped" id="usersTable"
               data-bind="simpleGrid: gridViewModel,simpleGridTemplate:'ko_rolesGrid',pageLinksId:'rolesPagination'">
        </table>
        <div id="rolesPagination"></div>
    </div>
    <div id="role-edit"></div>
  </div>

</script>

<script id="editRoleTab" type="text/x-jquery-tmpl">
  <div class="page-header">
    <h3>${$.i18n.prop('role')}</h3>
  </div>
  <table class="bordered-table" id="editRoleTable">
    <tbody>
      <tr>
        <td>${$.i18n.prop('name')}:</td>
        <td id="role-edit-name">${$data.name}</td>
      </tr>
      <tr>
        <td>${$.i18n.prop('description')}:</td>
        <td><input type="text" id="role-edit-description" data-bind="value: description"></td>
      </tr>
      <tr>
        <td colspan="2">
          <div class="pull-left">
            <button class="btn" data-bind="click: saveRoleDescription">${$.i18n.prop('save')}</button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>

  <div class="page-header">
    <h3>${$.i18n.prop('role.model.parent.roles')}</h3>
  </div>
  {{if $data.parentRoleNames}}
    <ul>
        {{each $data.parentRoleNames}}
          <li>${$value}</li>
        {{/each}}

    </ul>
  {{/if}}

  <div class="page-header">
    <h3>${$.i18n.prop('role.model.child.roles')}</h3>
  </div>
  {{if $data.childRoleNames}}
    <ul>
        {{each $data.childRoleNames}}
          <li>${$value}</li>
        {{/each}}
    </ul>
  {{/if}}

  <div class="page-header">
    <h3>${$.i18n.prop('permissions')}</h3>
  </div>
  {{if $data.permissions}}
    <table class="bordered-table zebra-striped" id="rolePermissionsTable">
      <thead>
        <tr>
          <th>${$.i18n.prop('name')}</th>
          <th>${$.i18n.prop('role.operation')}</th>
          <th>${$.i18n.prop('role.resource')}</th>
        </tr>
      </thead>
      <tbody>
          {{each permissions}}
            <tr>
              <td>${$value.name}</td>
              {{if $value.operation }}
                <td>${$value.operation.name}</td>
              {{else}}
                <td></td>
              {{/if}}
              {{if $value.resource }}
                <td>${$value.resource.identifier}</td>
              {{else}}
                <td></td>
              {{/if}}
            </tr>
          {{/each}}
      </tbody>
    </table>
  {{/if}}

  <div class="page-header">
    <h2>${$.i18n.prop('role.edit.section.users')}</h2>
  </div>
  {{if $data.parentsRolesUsers}}
    <div class="page-header">
      <h3>${$.i18n.prop('role.edit.users.defined.in.parent.roles')}</h3>
    </div>
      <ul>
      {{each $data.parentsRolesUsers}}
        <li>${$value.fullName} - ( ${$value.username} - ${$value.email} ) </li>
      {{/each}}
      </ul>
  {{/if}}

  <ul id="role-edit-users-tabs" class="pills">
    <li class="active">
      <a href="#role-view-users">${$.i18n.prop('role.edit.users.list')}</a>
    </li>
    <li>
      <a href="#role-edit-users">${$.i18n.prop('edit')}</a>
    </li>
  </ul>  

  <div class="pill-content" id="role-edit-users-tabs-content">
      <div id="role-view-users" class="active">
        <div class="page-header">
          <h3>${$.i18n.prop('role.edit.users.defined.in.current.role')}</h3>
        </div>
        <div id="role-list-users">
          {{if $data.users}}
              <ul>
              {{each users}}
                <li>${$value.fullName} - ( ${$value.username} - ${$value.email} ) </li>
              {{/each}}
              </ul>
          {{else}}
            ${$.i18n.prop('role.edit.no.user.defined')}
          {{/if}}
        </div>
      </div>

      <div id="role-edit-users" class="clearfix ar-multiselect">

        <div class="ar-multiselect-column ar-multiselect-left">
        <select data-bind="options: otherUsers ,optionsText: 'username',selectedOptions:selectedOtherUsers" multiple="true" id="role-edit-available-users"></select>
        </div>
        <div class="ar-multiselect-column ar-multiselect-center">
        <ul style="list-style: none">
          <li><input class="btn" id="role-edit-users-add-user" type="button" data-bind="click: addUser" value="&gt;"/></li>
          <li><input class="btn" id="role-edit-users-remove-user" type="button" data-bind="click: removeUser" value="&lt;"/></li>
        </ul>
        </div>
        <div class="ar-multiselect-column ar-multiselect-right">
          <select data-bind="options: users ,optionsText: 'username',selectedOptions:selectedUsers" multiple="true" id="role-edit-affected-users"></select>
        </div>
        <button class="btn" id="role-edit-users-save" data-bind="click: saveUsers">${$.i18n.prop('save')}</button>
      </div>
  </div>
</script>




<script id='ko_rolesGrid' type='text/x-jquery-tmpl'>
  <thead>
      <tr>
        {{each(i, columnDefinition) columns}}
          <th>${ columnDefinition.headerText }</th>
        {{/each}}
        <th>${$.i18n.prop('edit')}</th>

      </tr>
  </thead>
  <tbody>
      {{each(i, row) itemsOnCurrentPage()}}
          <tr>
              {{each(j, columnDefinition) columns}}
              <td>${ typeof columnDefinition.rowText == 'function' ? columnDefinition.rowText(row) : row[columnDefinition.rowText] }</td>
              {{/each}}
              <td><a href="#" data-bind="click: function(){ window.redbackModel.rolesViewModel.editRole(row) }">Edit</a></td>
          </tr>
      {{/each}}
  </tbody>

</script>


